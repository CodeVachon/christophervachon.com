function fnUpdatePreview(){$(".previewPane article header h1, .previewPane article header p.title a").html($('form[name="articleForm"] [name="title"]').val()),$(".previewPane article header p.date").html("Posted: "+$('form[name="articleForm"] [name="publicationDate"]').val()),$(".previewPane article.blog-summary section").html($('form[name="articleForm"] [name="summary"]').val()),$(".previewPane #articlePreview section").html($('form[name="articleForm"] [name="body"]').val()),_toggleLibraries&&$(".previewPane #articlePreview section").find("pre > code").size()>0&&$("code").highlightSyntax({definitionsPath:"/includes/js/definitions/"})}function fnGetMaxScrollTopValue(a){var b=a[0].scrollHeight,c=a.height();return b-c}function fnSortAWSKeys(a){var b="sortAWSKeys";console.groupCollapsed(b),console.log("Sort AWS Keys"),console.log("Data: "),console.log(a);for(var c={},d=a.length,e=0;d>e;e++){var f=a[e].Key;console.log("Parse Key:"+f);var g=f.split("/");console.log(g);for(var h=g.length,i="",j=0;h>j;j++){var k=g[j];k.length>0&&(fnIsFile(k)?(console.log(k+" is a File"),_current=deepFind(c,i.replace(/\.$/,"")),_current[k]=a[e]):(console.log(k+" is a Folder"),_current=deepFind(c,i.replace(/\.$/,"")),_current[k]||(_current[k]={}),i+=k+".",console.log("set new path: "+i)))}}return console.groupEnd(b),c}function deepFind(a,b){for(var c=b.split("."),d=a,e=0;e<c.length;++e)d[c[e]]?d=d[c[e]]:console.log(d[c[e]]+" Error");return d}function fnIsFile(a){return a.match(/\.[a-zA-Z0-9_]{2,5}/gi)}function fnDrawFolderList(a){var b=$("<ul>");for(var c in a){var d=$("<a>").prop({href:"#"}).html(c),e=$("<li>").html(d);fnIsFile(c)?(console.log(a[c]),d.addClass("file").prepend($("<span>").addClass("glyphicon glyphicon-picture")).attr("data-img-url","https://s3.amazonaws.com/"+_s3Bucket+"/"+a[c].Key).on("click",showFileDetails)):(d.addClass("folder").prepend($("<span>").addClass("glyphicon glyphicon-folder-close")).on("click",toggleFolders),e.append(fnDrawFolderList(a[c]).addClass("closed").hide())),b.append(e)}return b}function toggleFolders(a){a.preventDefault();var b=$(this).next("ul");b.hasClass("closed")?(b.removeClass("closed").show(),$(this).children(".glyphicon").removeClass("glyphicon-folder-close").addClass("glyphicon-folder-open")):(b.addClass("closed").hide(),$(this).children(".glyphicon").removeClass("glyphicon-folder-open").addClass("glyphicon-folder-close"))}function showFileDetails(a){a.preventDefault(),$(this).closest(".file-selector").find(".active").removeClass("active"),$(this).addClass("active");var b=$("<img>").addClass("previewImage").prop({src:$(this).attr("data-img-url"),alt:$(this).text()}),c=$("<input>").addClass("form-control").prop({type:"text",readonly:!0}).val($(this).attr("data-img-url"));$(".file-information").html("").append($("<p>").html($(this).text())).append(b).append(c)}var _toggleLibraries=!0,_s3Bucket="christophervachon",_s3Data={};$(document).ready(function(){$('[name="body"]').on("change",function(){fnUpdatePreview()}),$(".previewPane").on("click","a",function(a){a.preventDefault(),alert("Click to "+$(this).prop("href")+" Prevented!")}),$(".s3-library").on("click",function(a){a.preventDefault(),console.log("open  s3");var b=$("<div>").html("Loading..."),c=new AWS.S3({params:{Bucket:_s3Bucket}});params={},c.listObjects(params,function(a,c){if(a)console.log(a,a.stack),b.html($("<div>").addClass("alert alert-danger").html("An Error Occured Contacting S3. View Console for Details"));else{console.log(c),_s3Data=fnSortAWSKeys(c.Contents);var d=$("<div>").addClass("file-explorer row").append($("<div>").addClass("file-selector col-xs-8").html(fnDrawFolderList(_s3Data))).append($("<div>").addClass("file-information col-xs-4").html("Select a File"));b.html(d)}});var d=$("<div>").addClass("modal fade").append($("<div>").addClass("modal-dialog modal-lg").append($("<div>").addClass("modal-content").append($("<div>").addClass("modal-header").append($("<button>").addClass("close").attr("data-dismiss","modal").append($("<span>").html("&times;"))).append($("<h4>").addClass("modal-title").html("S3 Library"))).append($("<div>").addClass("modal-body").append(b)).append($("<div>").addClass("modal-footer").append($("<button>").addClass("btn btn-primary").attr("data-dismiss","modal").html("Close")))));d.modal("show")}),_toggleLibraries&&$(".toggleLibraries").addClass("active"),$(".toggleLibraries").on("click",function(a){a.preventDefault(),_toggleLibraries?(_toggleLibraries=!1,$(this).removeClass("active")):(_toggleLibraries=!0,$(this).addClass("active")),fnUpdatePreview()}),$(".previewPane .btn").remove(),$("#markdown").on("scroll",function(){var a=$(this).scrollTop(),b=fnGetMaxScrollTopValue($(this)),c=parseInt(a/b*100),d=$(".previewPane"),e=fnGetMaxScrollTopValue(d);d.scrollTop(e*(c/100))})}),new Vue({el:"#editorForm",filters:{marked:marked},methods:{onKeyUp:function(){fnUpdatePreview()}}});